!function(t){var e=function(e,r){function s(t){return void 0!==t?d[t]:d}function a(){return 20*Math.random(0,1)}var i,c=o(e)[0],d={total:100,current:0,flag:95,state:"load"};this.start=function(){var t=this;"man"!=r.end&&t.evtHanlde(),t.set(0),i=setInterval(function(){t.process()},200)},this.set=function(t){d.current=t,c.style.width=t/d.total*100+"%",console.log(s("current"),"Progress")},this.process=function(){var t=this,e=s(),n=a()+e.current;"load"===e.state&&n<=e.flag&&t.set(n)},this.done=function(){var t=this,e=s();e.state="done",t.set(e.total),t.destory(),console.log("完成了")},this.destory=function(){setTimeout(function(){c.style.display="none"},1e3),clearInterval(i)},this.evtHanlde=function(){var e=this;n.addEvent(t,"load",function(){e.done()})}};t.progress&&(t._progress=progress);var n={addEvent:function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener&&t.addEventListener(e,n,!1)},removeEvent:function(t,e,n){t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener&&t.removeEventListener(e,n,!1)}},o=function(t,e){var n=(e||(e=document)).querySelectorAll(t);return Array.prototype.slice.call(n,0)};t.Progress=e}(window);